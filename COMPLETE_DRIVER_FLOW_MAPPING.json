{
  "metadata": {
    "version": "4.9.5+",
    "generated": "2025-10-25T03:32:00Z",
    "source": "User-provided ultra-detailed inventory",
    "total_drivers": 164,
    "active_drivers": 140,
    "archived_drivers": 24,
    "description": "Complete professional flow card mapping for all Universal Tuya Zigbee drivers"
  },
  "drivers": {
    "air_quality_comprehensive": {
      "type": "air_quality",
      "capabilities": ["measure_pm25","measure_co2","measure_voc","measure_temperature","measure_humidity","alarm_airquality"],
      "actions": [
        {"id": "start_measurement", "title": {"en": "Start Measurement (one-shot)", "fr": "Lancer mesure"}},
        {"id": "set_reporting_interval", "title": {"en": "Set Reporting Interval (sec)", "fr": "Réglage intervalle"}, "args": [{"type": "number", "name": "interval"}]},
        {"id": "reset_averages", "title": {"en": "Reset Averages", "fr": "Réinitialiser moyennes"}},
        {"id": "calibrate_co2_baseline", "title": {"en": "Calibrate CO2 Baseline", "fr": "Calibrer CO2"}},
        {"id": "export_snapshot", "title": {"en": "Export Snapshot", "fr": "Exporter instantané"}}
      ],
      "triggers": [
        {"id": "pm25_above", "title": {"en": "PM2.5 Above [[threshold]]", "fr": "PM2.5 > [[threshold]]"}, "args": [{"type": "number", "name": "threshold"}], "tokens": [{"name": "pm25", "type": "number"}]},
        {"id": "co2_above", "title": {"en": "CO2 Above [[threshold]]", "fr": "CO2 > [[threshold]]"}, "args": [{"type": "number", "name": "threshold"}], "tokens": [{"name": "co2", "type": "number"}]},
        {"id": "voc_above", "title": {"en": "VOC Above [[threshold]]", "fr": "VOC > [[threshold]]"}, "args": [{"type": "number", "name": "threshold"}], "tokens": [{"name": "voc", "type": "number"}]},
        {"id": "aqi_category_changed", "title": {"en": "AQI Category Changed", "fr": "Catégorie AQI changée"}, "tokens": [{"name": "category", "type": "string"}]},
        {"id": "air_quality_degraded", "title": {"en": "Air Quality Degraded (trend)", "fr": "Dégradation tendance"}}
      ],
      "conditions": [
        {"id": "pm25_between", "title": {"en": "PM2.5 between [[min]] and [[max]]", "fr": "PM2.5 entre [[min]] et [[max]]"}, "args": [{"type": "number", "name": "min"}, {"type": "number", "name": "max"}]},
        {"id": "co2_trend", "title": {"en": "CO2 !{{rising|falling}}", "fr": "CO2 !{{en hausse|en baisse}}"}},
        {"id": "humidity_outside_range", "title": {"en": "Humidity outside range", "fr": "Humidité hors plage"}}
      ],
      "notes": "Create aggregate triggers (daily average, 1h trend). Support data tokens for flows."
    },
    
    "blind_roller_controller": {
      "type": "blind/shutter",
      "capabilities": ["windowcoverings_set","windowcoverings_state","measure_power"],
      "actions": [
        {"id": "open", "title": {"en": "Open (full)", "fr": "Ouvrir (complet)"}},
        {"id": "close", "title": {"en": "Close (full)", "fr": "Fermer (complet)"}},
        {"id": "set_position", "title": {"en": "Set Position [[position]]%", "fr": "Position [[position]]%"}, "args": [{"type": "range", "name": "position", "min": 0, "max": 100}]},
        {"id": "stop", "title": {"en": "Stop Movement", "fr": "Arrêter mouvement"}},
        {"id": "calibrate_travel", "title": {"en": "Calibrate Travel", "fr": "Calibrer course"}},
        {"id": "set_speed", "title": {"en": "Set Speed (ms)", "fr": "Vitesse (ms)"}, "args": [{"type": "number", "name": "speed"}]}
      ],
      "triggers": [
        {"id": "position_changed", "title": {"en": "Position Changed", "fr": "Position changée"}, "tokens": [{"name": "position", "type": "number"}]},
        {"id": "fully_opened", "title": {"en": "Fully Opened", "fr": "Complètement ouvert"}},
        {"id": "fully_closed", "title": {"en": "Fully Closed", "fr": "Complètement fermé"}},
        {"id": "obstruction_detected", "title": {"en": "Obstruction Detected (overcurrent)", "fr": "Obstruction détectée"}}
      ],
      "conditions": [
        {"id": "position_above", "title": {"en": "Position > [[level]]%", "fr": "Position > [[level]]%"}, "args": [{"type": "range", "name": "level"}]},
        {"id": "is_moving", "title": {"en": "Is moving", "fr": "En mouvement"}},
        {"id": "motor_current_above", "title": {"en": "Motor current > threshold", "fr": "Courant moteur > seuil"}}
      ],
      "notes": "Add auto-calibration macros and obstruction safety flows (auto-stop & reverse option)."
    },
    
    "button_emergency_advanced": {
      "type": "button/emergency",
      "capabilities": ["button","battery","alarm_sos"],
      "actions": [
        {"id": "simulate_button", "title": {"en": "Simulate Button [[button]] Press", "fr": "Simuler bouton [[button]]"}, "args": [{"type": "number", "name": "button"}]},
        {"id": "send_sos", "title": {"en": "Send SOS Notification (High Priority)", "fr": "Envoyer SOS (Haute priorité)"}},
        {"id": "arm_emergency", "title": {"en": "!{{Arm|Disarm}} Emergency", "fr": "!{{Armer|Désarmer}} urgence"}}
      ],
      "triggers": [
        {"id": "sos_pressed", "title": {"en": "SOS Pressed (short)", "fr": "SOS pressé (court)"}},
        {"id": "sos_long_hold", "title": {"en": "SOS Long Hold", "fr": "SOS maintenu"}},
        {"id": "panic_released", "title": {"en": "Panic Released", "fr": "Panique relâché"}},
        {"id": "double_press", "title": {"en": "Double Press", "fr": "Double pression"}}
      ],
      "conditions": [
        {"id": "last_press", "title": {"en": "Last Press = [[button]]", "fr": "Dernière pression = [[button]]"}},
        {"id": "battery_low", "title": {"en": "Battery Low", "fr": "Batterie faible"}},
        {"id": "armed_state", "title": {"en": "Armed State", "fr": "État armé"}}
      ],
      "notes": "SOS flows must be high-priority (tokens: location, timestamp). Add rate-limit and accidental-press protection."
    },
    
    "ceiling_fan": {
      "type": "fan/light combo",
      "capabilities": ["onoff","fan_speed","light_onoff","dim","measure_power"],
      "actions": [
        {"id": "fan_onoff", "title": {"en": "Turn Fan !{{On|Off}}", "fr": "Ventilateur !{{On|Off}}"}},
        {"id": "set_fan_speed", "title": {"en": "Set Fan Speed [[level]]", "fr": "Vitesse ventilateur [[level]]"}, "args": [{"type": "range", "name": "level", "min": 1, "max": 5}]},
        {"id": "toggle_direction", "title": {"en": "Toggle Fan Direction", "fr": "Inverser direction"}},
        {"id": "light_onoff", "title": {"en": "Set Light !{{On|Off}}", "fr": "Lumière !{{On|Off}}"}},
        {"id": "set_light_brightness", "title": {"en": "Set Light Brightness [[brightness]]%", "fr": "Luminosité [[brightness]]%"}, "args": [{"type": "range", "name": "brightness"}]},
        {"id": "sync_scene", "title": {"en": "Sync Light & Fan Scene", "fr": "Synchroniser scène"}}
      ],
      "triggers": [
        {"id": "fan_speed_changed", "title": {"en": "Fan Speed Changed", "fr": "Vitesse changée"}, "tokens": [{"name": "speed", "type": "number"}]},
        {"id": "direction_changed", "title": {"en": "Direction Changed", "fr": "Direction changée"}},
        {"id": "light_onoff", "title": {"en": "Light !{{turned on|turned off}}", "fr": "Lumière !{{allumée|éteinte}}"}},
        {"id": "power_above", "title": {"en": "Power > [[threshold]]", "fr": "Puissance > [[threshold]]"}}
      ],
      "conditions": [
        {"id": "fan_speed_above", "title": {"en": "Fan Speed > [[level]]", "fr": "Vitesse > [[level]]"}},
        {"id": "light_is_on", "title": {"en": "Light is On", "fr": "Lumière allumée"}},
        {"id": "direction_is_reversed", "title": {"en": "Direction is Reversed", "fr": "Direction inversée"}}
      ],
      "notes": "Combined controls: add group macros (fan+light) and safety stop on overload."
    },
    
    "contact_sensor": {
      "type": "contact",
      "capabilities": ["alarm_contact","tamper","battery","measure_temperature"],
      "actions": [
        {"id": "force_open", "title": {"en": "Force Open", "fr": "Forcer ouvert"}},
        {"id": "force_closed", "title": {"en": "Force Closed", "fr": "Forcer fermé"}},
        {"id": "reset_tamper", "title": {"en": "Reset Tamper", "fr": "RAZ sabotage"}},
        {"id": "set_open_timeout", "title": {"en": "Set Open Timeout", "fr": "Délai ouverture"}, "args": [{"type": "number", "name": "minutes"}]}
      ],
      "triggers": [
        {"id": "opened", "title": {"en": "Opened", "fr": "Ouvert"}},
        {"id": "closed", "title": {"en": "Closed", "fr": "Fermé"}},
        {"id": "left_open", "title": {"en": "Left Open > [[minutes]] min", "fr": "Resté ouvert > [[minutes]] min"}, "args": [{"type": "number", "name": "minutes"}]},
        {"id": "tamper_detected", "title": {"en": "Tamper Detected", "fr": "Sabotage détecté"}}
      ],
      "conditions": [
        {"id": "is_open", "title": {"en": "Is !{{open|closed}}", "fr": "Est !{{ouvert|fermé}}"}},
        {"id": "open_duration", "title": {"en": "Open duration > [[minutes]]", "fr": "Durée ouverture > [[minutes]]"}}
      ],
      "notes": "Add left-open reminders and auto-close virtual flows for gates/doors with motors."
    },
    
    "doorbell": {
      "type": "doorbell",
      "capabilities": ["button","alarm_motion","battery","image_snapshot"],
      "actions": [
        {"id": "simulate_ring", "title": {"en": "Simulate Ring", "fr": "Simuler sonnerie"}},
        {"id": "send_snapshot", "title": {"en": "Send Snapshot", "fr": "Envoyer snapshot"}},
        {"id": "mute_chime", "title": {"en": "!{{Mute|Unmute}} Chime", "fr": "!{{Silence|Activer}} carillon"}},
        {"id": "start_recording", "title": {"en": "Start Recording", "fr": "Démarrer enregistrement"}}
      ],
      "triggers": [
        {"id": "doorbell_rang", "title": {"en": "Doorbell Rang", "fr": "Sonnette activée"}, "tokens": [{"name": "snapshot", "type": "image"}]},
        {"id": "motion_detected", "title": {"en": "Motion Detected", "fr": "Mouvement détecté"}},
        {"id": "person_detected", "title": {"en": "Person Detected", "fr": "Personne détectée"}}
      ],
      "conditions": [
        {"id": "is_muted", "title": {"en": "Is Muted", "fr": "Est silencieux"}},
        {"id": "time_window", "title": {"en": "Time Window", "fr": "Plage horaire"}}
      ],
      "notes": "Add camera snapshot token and push with image support; rate-limit repeated rings."
    },
    
    "lock_smart": {
      "type": "lock",
      "capabilities": ["lock","lock_codes","tamper","battery","alarm"],
      "actions": [
        {"id": "lock", "title": {"en": "Lock", "fr": "Verrouiller"}},
        {"id": "unlock", "title": {"en": "Unlock", "fr": "Déverrouiller"}},
        {"id": "add_code", "title": {"en": "Add Code [[code]]", "fr": "Ajouter code [[code]]"}, "args": [{"type": "text", "name": "code"}]},
        {"id": "delete_code", "title": {"en": "Delete Code", "fr": "Supprimer code"}},
        {"id": "set_autolock", "title": {"en": "Set Auto-Lock Timer", "fr": "Timer auto-verrouillage"}},
        {"id": "enable_remote_unlock", "title": {"en": "!{{Enable|Disable}} Remote Unlock", "fr": "!{{Activer|Désactiver}} déverrouillage distant"}}
      ],
      "triggers": [
        {"id": "locked", "title": {"en": "Locked", "fr": "Verrouillé"}, "tokens": [{"name": "user", "type": "string"}, {"name": "timestamp", "type": "string"}]},
        {"id": "unlocked", "title": {"en": "Unlocked", "fr": "Déverrouillé"}, "tokens": [{"name": "user", "type": "string"}]},
        {"id": "wrong_code_attempt", "title": {"en": "Wrong Code Attempt", "fr": "Code erroné"}},
        {"id": "tamper_detected", "title": {"en": "Tamper Detected", "fr": "Sabotage détecté"}}
      ],
      "conditions": [
        {"id": "is_locked", "title": {"en": "Is Locked", "fr": "Est verrouillé"}},
        {"id": "code_exists", "title": {"en": "Code Exists", "fr": "Code existe"}}
      ],
      "notes": "Enable audit logs tokens (user, timestamp) and require confirmation for code changes."
    },
    
    "motion_sensor": {
      "type": "motion",
      "capabilities": ["alarm_motion","measure_luminance","battery"],
      "actions": [
        {"id": "enable", "title": {"en": "Enable Sensor", "fr": "Activer capteur"}},
        {"id": "disable", "title": {"en": "Disable Sensor", "fr": "Désactiver capteur"}},
        {"id": "set_sensitivity", "title": {"en": "Set Sensitivity [[level]]", "fr": "Sensibilité [[level]]"}, "args": [{"type": "range", "name": "level"}]},
        {"id": "set_reporting_interval", "title": {"en": "Set Reporting Interval", "fr": "Intervalle rapport"}},
        {"id": "set_timeout", "title": {"en": "Set No-Motion Timeout", "fr": "Délai sans mouvement"}}
      ],
      "triggers": [
        {"id": "motion_detected", "title": {"en": "Motion Detected", "fr": "Mouvement détecté"}},
        {"id": "no_motion", "title": {"en": "No Motion (timeout)", "fr": "Pas de mouvement"}},
        {"id": "motion_and_dark", "title": {"en": "Motion + Lux < [[threshold]]", "fr": "Mouvement + Lux < [[threshold]]"}, "args": [{"type": "number", "name": "threshold"}]}
      ],
      "conditions": [
        {"id": "motion_in_last_minutes", "title": {"en": "Motion in last [[minutes]] min", "fr": "Mouvement < [[minutes]] min"}, "args": [{"type": "number", "name": "minutes"}]},
        {"id": "battery_low", "title": {"en": "Battery Low", "fr": "Batterie faible"}}
      ],
      "notes": "Provide debounce and minimum interval to reduce battery drain."
    },
    
    "thermostat_advanced": {
      "type": "thermostat",
      "capabilities": ["target_temperature","measure_temperature","thermostat_mode","schedule"],
      "actions": [
        {"id": "set_target_temp", "title": {"en": "Set Target Temperature [[temp]]°C", "fr": "Température cible [[temp]]°C"}, "args": [{"type": "number", "name": "temp"}]},
        {"id": "set_mode", "title": {"en": "Set Mode [[mode]]", "fr": "Mode [[mode]]"}, "args": [{"type": "dropdown", "name": "mode", "values": [{"id": "heat"}, {"id": "cool"}, {"id": "auto"}, {"id": "off"}]}]},
        {"id": "apply_schedule", "title": {"en": "Apply Schedule", "fr": "Appliquer programme"}},
        {"id": "set_eco_temp", "title": {"en": "Set Eco Temp", "fr": "Température éco"}}
      ],
      "triggers": [
        {"id": "target_reached", "title": {"en": "Target Reached", "fr": "Cible atteinte"}},
        {"id": "mode_changed", "title": {"en": "Mode Changed", "fr": "Mode changé"}, "tokens": [{"name": "mode", "type": "string"}]},
        {"id": "schedule_triggered", "title": {"en": "Schedule Triggered", "fr": "Programme déclenché"}}
      ],
      "conditions": [
        {"id": "mode_is", "title": {"en": "Mode is [[mode]]", "fr": "Mode est [[mode]]"}},
        {"id": "temp_delta", "title": {"en": "Temperature delta > [[delta]]", "fr": "Delta température > [[delta]]"}}
      ],
      "notes": "Support schedule import/export and multi-zone strategies."
    },
    
    "water_valve_smart_hybrid": {
      "type": "valve/hybrid",
      "capabilities": ["valve_state","onoff","switch_mode","alarm_water"],
      "actions": [
        {"id": "open", "title": {"en": "Open Valve", "fr": "Ouvrir vanne"}},
        {"id": "close", "title": {"en": "Close Valve", "fr": "Fermer vanne"}},
        {"id": "set_mode", "title": {"en": "Set Mode [[mode]]", "fr": "Mode [[mode]]"}, "args": [{"type": "dropdown", "name": "mode", "values": [{"id": "hybrid"}, {"id": "local"}]}]},
        {"id": "emergency_close", "title": {"en": "Emergency Close", "fr": "Fermeture urgence"}},
        {"id": "set_schedule", "title": {"en": "Set Schedule", "fr": "Programmer"}}
      ],
      "triggers": [
        {"id": "valve_state_changed", "title": {"en": "Valve State Changed", "fr": "État vanne changé"}},
        {"id": "mode_changed", "title": {"en": "Mode Changed", "fr": "Mode changé"}},
        {"id": "leak_detected", "title": {"en": "Leak Detected", "fr": "Fuite détectée"}}
      ],
      "conditions": [
        {"id": "mode_is", "title": {"en": "Mode is [[mode]]", "fr": "Mode est [[mode]]"}},
        {"id": "valve_is_open", "title": {"en": "Valve is Open", "fr": "Vanne ouverte"}}
      ],
      "notes": "Hybrid valve: support cloud/local fallback and emergency shutoff."
    },
    
    "wall_touch_3gang_hybrid": {
      "type": "switch/touch/hybrid",
      "capabilities": ["onoff.channel1","onoff.channel2","onoff.channel3","switch_mode","touch_event"],
      "actions": [
        {"id": "channel1_on", "title": {"en": "Channel 1 On", "fr": "Canal 1 On"}},
        {"id": "channel1_off", "title": {"en": "Channel 1 Off", "fr": "Canal 1 Off"}},
        {"id": "channel2_on", "title": {"en": "Channel 2 On", "fr": "Canal 2 On"}},
        {"id": "channel2_off", "title": {"en": "Channel 2 Off", "fr": "Canal 2 Off"}},
        {"id": "channel3_on", "title": {"en": "Channel 3 On", "fr": "Canal 3 On"}},
        {"id": "channel3_off", "title": {"en": "Channel 3 Off", "fr": "Canal 3 Off"}},
        {"id": "set_mode", "title": {"en": "Set Mode [[mode]]", "fr": "Mode [[mode]]"}, "args": [{"type": "dropdown", "name": "mode", "values": [{"id": "hybrid"}, {"id": "local"}]}]},
        {"id": "map_touch_to_scene", "title": {"en": "Map Touch pattern to Scene", "fr": "Mapper toucher vers scène"}},
        {"id": "set_channel_timer", "title": {"en": "Set Channel [[channel]] Timer", "fr": "Timer canal [[channel]]"}}
      ],
      "triggers": [
        {"id": "touch_ch1_single", "title": {"en": "Touch Channel 1 Single", "fr": "Toucher canal 1 simple"}},
        {"id": "touch_ch1_double", "title": {"en": "Touch Channel 1 Double", "fr": "Toucher canal 1 double"}},
        {"id": "touch_ch1_long", "title": {"en": "Touch Channel 1 Long", "fr": "Toucher canal 1 long"}},
        {"id": "touch_ch2_single", "title": {"en": "Touch Channel 2 Single", "fr": "Toucher canal 2 simple"}},
        {"id": "touch_ch2_double", "title": {"en": "Touch Channel 2 Double", "fr": "Toucher canal 2 double"}},
        {"id": "touch_ch2_long", "title": {"en": "Touch Channel 2 Long", "fr": "Toucher canal 2 long"}},
        {"id": "touch_ch3_single", "title": {"en": "Touch Channel 3 Single", "fr": "Toucher canal 3 simple"}},
        {"id": "touch_ch3_double", "title": {"en": "Touch Channel 3 Double", "fr": "Toucher canal 3 double"}},
        {"id": "touch_ch3_long", "title": {"en": "Touch Channel 3 Long", "fr": "Toucher canal 3 long"}},
        {"id": "mode_changed", "title": {"en": "Mode Changed", "fr": "Mode changé"}},
        {"id": "channel_overcurrent", "title": {"en": "Channel [[channel]] Overcurrent", "fr": "Canal [[channel]] surcourant"}}
      ],
      "conditions": [
        {"id": "channel1_is_on", "title": {"en": "Channel 1 is On", "fr": "Canal 1 actif"}},
        {"id": "channel2_is_on", "title": {"en": "Channel 2 is On", "fr": "Canal 2 actif"}},
        {"id": "channel3_is_on", "title": {"en": "Channel 3 is On", "fr": "Canal 3 actif"}},
        {"id": "mode_is", "title": {"en": "Mode is [[mode]]", "fr": "Mode est [[mode]]"}},
        {"id": "last_touch_pattern", "title": {"en": "Last Touch pattern", "fr": "Dernier motif toucher"}}
      ],
      "notes": "Supports 1→3 gang market range; auto-detect gang count and expose only used channels. Provide hybrid mode options and fallback to local when cloud unavailable."
    }
  }
}
