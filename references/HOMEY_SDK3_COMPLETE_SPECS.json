{
  "version": "3.0.0",
  "source": "https://apps.developer.homey.app",
  "last_updated": "2025-10-18",
  "verified": true,
  
  "image_specifications": {
    "app_images": {
      "location": "/assets/images/",
      "required_files": ["small.png", "large.png", "xlarge.png"],
      "dimensions": {
        "small": { 
          "width": 250, 
          "height": 175,
          "note": "Used in Homey App Store listings"
        },
        "large": { 
          "width": 500, 
          "height": 350,
          "note": "CRITICAL: Must be 500x350, NOT 500x500!"
        },
        "xlarge": { 
          "width": 1000, 
          "height": 700,
          "note": "High resolution app store image"
        }
      },
      "format": "PNG",
      "purpose": "App Store listing and app identification"
    },
    
    "driver_images": {
      "location": "/drivers/{driver_id}/assets/images/",
      "required_files": ["small.png", "large.png", "xlarge.png"],
      "dimensions": {
        "small": { 
          "width": 75, 
          "height": 75,
          "note": "Device icon in pairing wizard"
        },
        "large": { 
          "width": 500, 
          "height": 500,
          "note": "Device image in app"
        },
        "xlarge": { 
          "width": 1000, 
          "height": 1000,
          "note": "High resolution device image"
        }
      },
      "format": "PNG",
      "purpose": "Device pairing and identification",
      "app_json_requirement": {
        "critical": true,
        "description": "Each driver MUST have an 'images' object in app.json with absolute paths",
        "example": {
          "images": {
            "small": "/drivers/{driver_id}/assets/images/small.png",
            "large": "/drivers/{driver_id}/assets/images/large.png",
            "xlarge": "/drivers/{driver_id}/assets/images/xlarge.png"
          }
        },
        "consequence_if_missing": "Homey will use app images (250x175) instead of driver images (75x75), causing validation failure"
      }
    },
    
    "icon": {
      "location": "/assets/icon.svg",
      "format": "SVG",
      "size": "Single size (vector)",
      "purpose": "App icon displayed in Homey"
    }
  },
  
  "zigbee_driver_requirements": {
    "required_fields": [
      "manufacturerName",
      "productId",
      "endpoints",
      "learnmode"
    ],
    
    "learnmode": {
      "required": true,
      "format": {
        "instruction": {
          "en": "Press the pairing button on your device to start pairing.\n\nIf your device does not have a pairing button, check the device manual for pairing instructions.",
          "note": "English is required, other languages optional"
        }
      },
      "purpose": "User guidance during device pairing"
    },
    
    "manufacturerName": {
      "type": "array of strings",
      "description": "Zigbee manufacturer names and model IDs",
      "example": ["_TZ3000_abcd1234", "TS0041", "IKEA of Sweden"]
    },
    
    "productId": {
      "type": "array of strings",
      "description": "Product identifiers",
      "example": ["E2495"]
    },
    
    "endpoints": {
      "type": "object",
      "description": "Zigbee endpoint configuration",
      "example": {
        "1": {
          "clusters": [0, 1, 3, 6],
          "bindings": [1]
        }
      }
    }
  },
  
  "flow_card_requirements": {
    "unique_ids": {
      "required": true,
      "scope": "global",
      "description": "Flow card IDs must be unique across ALL drivers and app"
    },
    
    "device_token": {
      "required": true,
      "token": "[[device]]",
      "description": "Device flow cards must include [[device]] token in title/titleFormatted",
      "applies_to": ["triggers", "actions", "conditions"]
    },
    
    "titleFormatted": {
      "required_future": true,
      "current_status": "warning",
      "description": "Specifying titleFormatted will be required in future SDK versions",
      "patterns": {
        "action": "[[action]] [[device]] [[args]]",
        "condition": "[[device]] [[condition]] [[args]]",
        "trigger": "When [[device]] [[trigger]]"
      }
    }
  },
  
  "validation_levels": {
    "debug": {
      "description": "Basic validation for development",
      "use": "During active development"
    },
    "verified": {
      "description": "Standard validation for testing",
      "use": "Before submission to App Store"
    },
    "publish": {
      "description": "Strict validation for App Store",
      "use": "Final check before publication",
      "requirements": [
        "All images must have exact dimensions",
        "All drivers must have images object in app.json",
        "All flow card IDs must be unique",
        "All Zigbee drivers must have learnmode"
      ]
    }
  },
  
  "common_validation_errors": {
    "invalid_image_size_driver": {
      "error": "Invalid image size (250x175) drivers.{id}.small",
      "cause": "Missing images object in app.json for driver",
      "fix": "Add images object with absolute paths for each driver"
    },
    "invalid_image_size_app": {
      "error": "Invalid image size (500x500) large.png",
      "cause": "App large.png must be 500x350, not 500x500",
      "fix": "Resize with: magick assets/images/large.png -resize 500x350! assets/images/large.png"
    },
    "duplicate_flow_id": {
      "error": "Duplicate flow card ID",
      "cause": "Flow card ID used multiple times",
      "fix": "Make all flow card IDs globally unique"
    },
    "missing_learnmode": {
      "error": "Zigbee driver missing learnmode",
      "cause": "Required for all Zigbee drivers",
      "fix": "Add learnmode object with instruction.en"
    }
  },
  
  "build_and_validation_workflow": {
    "steps": [
      {
        "order": 1,
        "command": "Remove-Item -Recurse -Force .homeybuild",
        "description": "Clean previous build artifacts"
      },
      {
        "order": 2,
        "command": "homey app build",
        "description": "Build app from source files"
      },
      {
        "order": 3,
        "command": "homey app validate --level publish",
        "description": "Validate against App Store requirements"
      }
    ],
    "success_indicator": "âœ“ App validated successfully against level `publish`"
  },
  
  "critical_lessons_learned": {
    "app_large_png_dimensions": {
      "correct": "500x350",
      "incorrect": "500x500",
      "impact": "Validation failure at publish level"
    },
    "driver_images_object": {
      "required": true,
      "location": "app.json for each driver",
      "format": "absolute paths from project root",
      "without_it": "Drivers use app images (wrong dimensions)"
    },
    "always_clean_rebuild": {
      "reason": "Homey caches build artifacts",
      "command": "Remove-Item -Recurse -Force .homeybuild before homey app build"
    }
  }
}
