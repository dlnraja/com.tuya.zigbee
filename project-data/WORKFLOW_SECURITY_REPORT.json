{
  "timestamp": "2025-12-22T13:12:06.351Z",
  "scan_summary": {
    "workflows_scanned": 12,
    "violations_found": 17,
    "fixes_applied": 11
  },
  "security_violations": [
    {
      "file": "auto-publish-on-push.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "auto-publish-on-push.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: tools.developer.homey.app"
    },
    {
      "file": "forum-analysis-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "forum-analysis-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "homey-ci-cd.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "homey-ci-cd.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: tools.developer.homey.app"
    },
    {
      "file": "homey-ci-cd.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: homey.app"
    },
    {
      "file": "homey-publish.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "homey-publish.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "homey-publish.yml",
      "type": "excessive_permissions",
      "severity": "medium",
      "description": "Permissions trop larges - principe du moindre privilège non respecté"
    },
    {
      "file": "homey-publish.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: tools.developer.homey.app"
    },
    {
      "file": "homey-publish.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: homey.app"
    },
    {
      "file": "homey-validate.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "homey-validate.yml",
      "type": "untrusted_external_source",
      "severity": "medium",
      "description": "Source externe non approuvée: apps.developer.homey.app"
    },
    {
      "file": "homey-version.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "intelligent-weekly-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    },
    {
      "file": "monthly-enrichment.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "description": "Pattern potentiellement dangereux détecté - risque d'injection"
    }
  ],
  "security_fixes": [
    {
      "file": "auto-publish-on-push.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "forum-analysis-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "forum-analysis-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "homey-ci-cd.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "homey-publish.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "homey-publish.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "homey-publish.yml",
      "type": "excessive_permissions",
      "severity": "medium",
      "action": "fixed",
      "description": "Correction appliquée pour excessive_permissions"
    },
    {
      "file": "homey-validate.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "homey-version.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "intelligent-weekly-automation.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    },
    {
      "file": "monthly-enrichment.yml",
      "type": "dangerous_pattern",
      "severity": "high",
      "action": "fixed",
      "description": "Correction appliquée pour dangerous_pattern"
    }
  ],
  "security_score": 0,
  "recommendations": [
    "Utilisez toujours des versions fixes des actions (ex: @v4 au lieu de @main)",
    "Appliquez le principe du moindre privilège pour les permissions",
    "Validez toutes les entrées utilisateur avant utilisation",
    "Ne jamais exposer de secrets dans les logs ou outputs",
    "Utilisez des runners auto-hébergés avec prudence",
    "Implémentez une review obligatoire pour les modifications de workflows"
  ]
}