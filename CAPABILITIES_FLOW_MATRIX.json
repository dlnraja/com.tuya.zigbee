{
  "metadata": {
    "version": "4.9.5",
    "generated": "2025-10-25T03:08:00Z",
    "total_families": 12,
    "description": "Complete capabilities and flow cards matrix for Universal Tuya Zigbee"
  },
  "families": {
    "lights": {
      "emoji": "üü°",
      "types": ["bulb_rgb", "bulb_rgbw", "bulb_tunable_white", "bulb_dimmable", "led_strip"],
      "capabilities": ["onoff", "dim", "light_hue", "light_saturation", "light_temperature", "measure_power", "meter_power"],
      "flowCards": {
        "actions": [
          {"id": "turn_on", "title": {"en": "Turn on", "fr": "Allumer"}},
          {"id": "turn_off", "title": {"en": "Turn off", "fr": "√âteindre"}},
          {"id": "set_brightness", "title": {"en": "Set brightness", "fr": "D√©finir luminosit√©"}, "args": [{"type": "range", "name": "brightness", "min": 0, "max": 100}]},
          {"id": "set_color", "title": {"en": "Set color", "fr": "D√©finir couleur"}, "args": [{"type": "number", "name": "hue"}, {"type": "number", "name": "saturation"}]},
          {"id": "set_temperature", "title": {"en": "Set temperature (K)", "fr": "Temp√©rature (K)"}, "args": [{"type": "range", "name": "temperature", "min": 2700, "max": 6500}]},
          {"id": "apply_scene", "title": {"en": "Apply scene", "fr": "Appliquer sc√®ne"}}
        ],
        "triggers": [
          {"id": "turned_on", "title": {"en": "Turned on", "fr": "Allum√©"}},
          {"id": "turned_off", "title": {"en": "Turned off", "fr": "√âteint"}},
          {"id": "brightness_changed", "title": {"en": "Brightness changed", "fr": "Luminosit√© chang√©e"}, "tokens": [{"name": "brightness", "type": "number"}]},
          {"id": "power_above_threshold", "title": {"en": "Power > threshold", "fr": "Puissance > seuil"}, "args": [{"type": "number", "name": "threshold"}]}
        ],
        "conditions": [
          {"id": "is_on", "title": {"en": "Is !{{on|off}}", "fr": "Est !{{allum√©|√©teint}}"}},
          {"id": "brightness_above", "title": {"en": "Brightness > X", "fr": "Luminosit√© > X"}, "args": [{"type": "range", "name": "level"}]},
          {"id": "color_in_range", "title": {"en": "Color in range", "fr": "Couleur dans plage"}}
        ]
      },
      "smartMode": "Auto-detects color/dimmer/temperature clusters and enables only supported capabilities"
    },
    
    "plugs": {
      "emoji": "‚ö´",
      "types": ["plug_smart", "plug_energy_monitor", "plug_power_meter", "usb_outlet"],
      "capabilities": ["onoff", "meter_power", "measure_power", "meter_energy", "alarm_power"],
      "flowCards": {
        "actions": [
          {"id": "turn_on", "title": {"en": "Turn on", "fr": "Allumer"}},
          {"id": "turn_off", "title": {"en": "Turn off", "fr": "√âteindre"}},
          {"id": "toggle", "title": {"en": "Toggle", "fr": "Basculer"}},
          {"id": "power_cycle", "title": {"en": "Power cycle", "fr": "Cycle alimentation"}},
          {"id": "limit_power", "title": {"en": "Limit power", "fr": "Limiter puissance"}, "args": [{"type": "number", "name": "max_watts"}]},
          {"id": "reset_energy", "title": {"en": "Reset energy meter", "fr": "RAZ compteur"}}
        ],
        "triggers": [
          {"id": "power_above", "title": {"en": "Power > X W", "fr": "Puissance > X W"}, "args": [{"type": "number", "name": "watts"}], "tokens": [{"name": "power", "type": "number"}]},
          {"id": "energy_above", "title": {"en": "Energy > X kWh", "fr": "√ânergie > X kWh"}, "args": [{"type": "number", "name": "kwh"}]},
          {"id": "overload", "title": {"en": "Overload detected", "fr": "Surcharge d√©tect√©e"}}
        ],
        "conditions": [
          {"id": "is_on", "title": {"en": "Is !{{on|off}}", "fr": "Est !{{allum√©|√©teint}}"}},
          {"id": "power_in_range", "title": {"en": "Power in range", "fr": "Puissance dans plage"}}
        ]
      },
      "smartMode": "Adds automatic idle cut-off & overload alerts"
    },
    
    "switches": {
      "emoji": "üü¢",
      "types": ["switch_wall", "switch_touch", "switch_wireless", "scene_controller", "button_remote"],
      "capabilities": ["onoff", "button", "alarm_contact"],
      "flowCards": {
        "actions": [
          {"id": "simulate_press", "title": {"en": "Simulate press", "fr": "Simuler pression"}, "args": [{"type": "dropdown", "name": "button"}]}
        ],
        "triggers": [
          {"id": "button_pressed_single", "title": {"en": "Button pressed (single)", "fr": "Bouton press√© (simple)"}},
          {"id": "button_pressed_double", "title": {"en": "Button pressed (double)", "fr": "Bouton press√© (double)"}},
          {"id": "button_pressed_hold", "title": {"en": "Button held", "fr": "Bouton maintenu"}},
          {"id": "scene_activated", "title": {"en": "Scene activated", "fr": "Sc√®ne activ√©e"}}
        ],
        "conditions": [
          {"id": "last_button_equals", "title": {"en": "Last button = X", "fr": "Dernier bouton = X"}}
        ]
      },
      "smartMode": "Generates flow-cards dynamically based on event codes detected"
    },
    
    "contact": {
      "emoji": "üü†",
      "types": ["contact_sensor", "door_sensor", "window_sensor"],
      "capabilities": ["alarm_contact", "measure_battery", "alarm_tamper", "measure_temperature"],
      "flowCards": {
        "actions": [
          {"id": "force_open", "title": {"en": "Force open", "fr": "Forcer ouvert"}},
          {"id": "force_closed", "title": {"en": "Force closed", "fr": "Forcer ferm√©"}},
          {"id": "reset_tamper", "title": {"en": "Reset tamper", "fr": "RAZ sabotage"}}
        ],
        "triggers": [
          {"id": "opened", "title": {"en": "Opened", "fr": "Ouvert"}},
          {"id": "closed", "title": {"en": "Closed", "fr": "Ferm√©"}},
          {"id": "left_open", "title": {"en": "Left open > X min", "fr": "Rest√© ouvert > X min"}, "args": [{"type": "number", "name": "minutes"}]},
          {"id": "tamper", "title": {"en": "Tamper detected", "fr": "Sabotage d√©tect√©"}}
        ],
        "conditions": [
          {"id": "is_open", "title": {"en": "Is !{{open|closed}}", "fr": "Est !{{ouvert|ferm√©}}"}}
        ]
      },
      "smartMode": "Adjusts reporting interval depending on battery power"
    },
    
    "motion": {
      "emoji": "üîµ",
      "types": ["motion_sensor", "motion_sensor_pir", "motion_sensor_mmwave", "presence_sensor"],
      "capabilities": ["alarm_motion", "alarm_occupancy", "measure_luminance", "measure_battery"],
      "flowCards": {
        "actions": [
          {"id": "enable", "title": {"en": "Enable sensor", "fr": "Activer capteur"}},
          {"id": "disable", "title": {"en": "Disable sensor", "fr": "D√©sactiver capteur"}},
          {"id": "set_sensitivity", "title": {"en": "Set sensitivity", "fr": "D√©finir sensibilit√©"}, "args": [{"type": "range", "name": "level", "min": 0, "max": 100}]}
        ],
        "triggers": [
          {"id": "motion_detected", "title": {"en": "Motion detected", "fr": "Mouvement d√©tect√©"}},
          {"id": "motion_cleared", "title": {"en": "Motion cleared", "fr": "Mouvement termin√©"}},
          {"id": "motion_and_dark", "title": {"en": "Motion + dark (lux < X)", "fr": "Mouvement + sombre"}, "args": [{"type": "number", "name": "lux_threshold"}]}
        ],
        "conditions": [
          {"id": "motion_in_last_minutes", "title": {"en": "Motion in last X min", "fr": "Mouvement < X min"}, "args": [{"type": "number", "name": "minutes"}]}
        ]
      },
      "smartMode": "Dynamic debounce delay based on battery"
    },
    
    "climate": {
      "emoji": "üå°Ô∏è",
      "types": ["temperature_sensor", "climate_monitor", "climate_sensor_temp_humidity"],
      "capabilities": ["measure_temperature", "measure_humidity", "measure_pressure", "measure_battery"],
      "flowCards": {
        "actions": [
          {"id": "calibrate_offset", "title": {"en": "Calibrate offset", "fr": "Calibrer d√©calage"}, "args": [{"type": "number", "name": "offset"}]}
        ],
        "triggers": [
          {"id": "temperature_above", "title": {"en": "Temperature > X", "fr": "Temp√©rature > X"}, "args": [{"type": "number", "name": "degrees"}]},
          {"id": "temperature_below", "title": {"en": "Temperature < X", "fr": "Temp√©rature < X"}, "args": [{"type": "number", "name": "degrees"}]},
          {"id": "humidity_above", "title": {"en": "Humidity > X%", "fr": "Humidit√© > X%"}, "args": [{"type": "range", "name": "percent"}]}
        ],
        "conditions": [
          {"id": "temperature_in_range", "title": {"en": "Temperature in range", "fr": "Temp√©rature dans plage"}},
          {"id": "humidity_in_range", "title": {"en": "Humidity in range", "fr": "Humidit√© dans plage"}}
        ]
      },
      "smartMode": "Auto-aggregates multi-sensors to average values"
    },
    
    "curtains": {
      "emoji": "ü™ü",
      "types": ["curtain_motor", "blind_roller", "shutter_roller"],
      "capabilities": ["windowcoverings_set", "windowcoverings_state", "measure_power"],
      "flowCards": {
        "actions": [
          {"id": "open", "title": {"en": "Open", "fr": "Ouvrir"}},
          {"id": "close", "title": {"en": "Close", "fr": "Fermer"}},
          {"id": "set_position", "title": {"en": "Set position", "fr": "Position"}, "args": [{"type": "range", "name": "position", "min": 0, "max": 100}]},
          {"id": "calibrate_travel", "title": {"en": "Calibrate travel", "fr": "Calibrer course"}}
        ],
        "triggers": [
          {"id": "position_changed", "title": {"en": "Position changed", "fr": "Position chang√©e"}, "tokens": [{"name": "position", "type": "number"}]},
          {"id": "movement_started", "title": {"en": "Movement started", "fr": "Mouvement d√©marr√©"}},
          {"id": "movement_stopped", "title": {"en": "Movement stopped", "fr": "Mouvement arr√™t√©"}},
          {"id": "obstruction", "title": {"en": "Obstruction detected", "fr": "Obstruction d√©tect√©e"}}
        ],
        "conditions": [
          {"id": "position_above", "title": {"en": "Position > X%", "fr": "Position > X%"}},
          {"id": "is_moving", "title": {"en": "Is moving", "fr": "En mouvement"}}
        ]
      },
      "smartMode": "Chooses correct cluster (tilt vs roller) and applies safety stop"
    },
    
    "thermostat": {
      "emoji": "üî•",
      "types": ["thermostat_smart", "radiator_valve", "hvac_air_conditioner"],
      "capabilities": ["target_temperature", "measure_temperature", "thermostat_mode", "valve_state", "measure_power"],
      "flowCards": {
        "actions": [
          {"id": "set_target_temperature", "title": {"en": "Set target temperature", "fr": "Temp√©rature cible"}, "args": [{"type": "number", "name": "temperature"}]},
          {"id": "set_mode", "title": {"en": "Set mode", "fr": "D√©finir mode"}, "args": [{"type": "dropdown", "name": "mode", "values": ["heat", "cool", "off", "auto"]}]},
          {"id": "set_schedule", "title": {"en": "Set schedule", "fr": "Programmer"}}
        ],
        "triggers": [
          {"id": "target_reached", "title": {"en": "Target temperature reached", "fr": "Temp√©rature atteinte"}},
          {"id": "mode_changed", "title": {"en": "Mode changed", "fr": "Mode chang√©"}, "tokens": [{"name": "mode", "type": "string"}]}
        ],
        "conditions": [
          {"id": "mode_is", "title": {"en": "Mode is", "fr": "Mode est"}},
          {"id": "temperature_above_target", "title": {"en": "Above target", "fr": "Au-dessus cible"}}
        ]
      },
      "smartMode": "Schedule learning & valve vs thermostat detection"
    },
    
    "energy": {
      "emoji": "‚ö°",
      "types": ["meter_power", "solar_panel_controller"],
      "capabilities": ["meter_power", "meter_voltage", "meter_current", "meter_energy", "meter_frequency"],
      "flowCards": {
        "actions": [
          {"id": "export_snapshot", "title": {"en": "Export snapshot", "fr": "Exporter snapshot"}},
          {"id": "reset_counter", "title": {"en": "Reset counter", "fr": "RAZ compteur"}}
        ],
        "triggers": [
          {"id": "power_spike", "title": {"en": "Power spike", "fr": "Pic de puissance"}},
          {"id": "energy_threshold", "title": {"en": "Energy > threshold", "fr": "√ânergie > seuil"}},
          {"id": "phase_imbalance", "title": {"en": "Phase imbalance", "fr": "D√©s√©quilibre phases"}}
        ],
        "conditions": [
          {"id": "generation_active", "title": {"en": "Generation active", "fr": "G√©n√©ration active"}}
        ]
      },
      "smartMode": "Adds phase balance and daily aggregation triggers"
    },
    
    "smoke": {
      "emoji": "üö®",
      "types": ["smoke_detector", "gas_detector", "co_detector"],
      "capabilities": ["alarm_smoke", "alarm_co", "alarm_gas", "measure_battery", "alarm_tamper"],
      "flowCards": {
        "actions": [
          {"id": "silence_alarm", "title": {"en": "Silence alarm", "fr": "Silence alarme"}},
          {"id": "test_alarm", "title": {"en": "Test alarm", "fr": "Tester alarme"}}
        ],
        "triggers": [
          {"id": "alarm_detected", "title": {"en": "Alarm detected", "fr": "Alarme d√©tect√©e"}},
          {"id": "alarm_cleared", "title": {"en": "Alarm cleared", "fr": "Alarme effac√©e"}}
        ],
        "conditions": [
          {"id": "is_alarming", "title": {"en": "Is alarming", "fr": "En alarme"}}
        ]
      },
      "smartMode": "Critical-path push trigger + linked automation"
    },
    
    "water": {
      "emoji": "üíß",
      "types": ["water_leak_sensor", "water_valve"],
      "capabilities": ["alarm_water", "measure_battery", "measure_temperature", "onoff"],
      "flowCards": {
        "actions": [
          {"id": "close_valve", "title": {"en": "Close valve", "fr": "Fermer vanne"}},
          {"id": "open_valve", "title": {"en": "Open valve", "fr": "Ouvrir vanne"}},
          {"id": "emergency_shutoff", "title": {"en": "Emergency shutoff", "fr": "Coupure urgence"}}
        ],
        "triggers": [
          {"id": "leak_detected", "title": {"en": "Leak detected", "fr": "Fuite d√©tect√©e"}},
          {"id": "leak_cleared", "title": {"en": "Leak cleared", "fr": "Fuite r√©solue"}},
          {"id": "valve_closed", "title": {"en": "Valve closed", "fr": "Vanne ferm√©e"}}
        ],
        "conditions": [
          {"id": "is_leaking", "title": {"en": "Is leaking", "fr": "En fuite"}},
          {"id": "valve_is_open", "title": {"en": "Valve is open", "fr": "Vanne ouverte"}}
        ]
      },
      "smartMode": "Link automatically to Tuya water valve device if paired"
    },
    
    "wall_touch_gang": {
      "emoji": "üéõÔ∏è",
      "types": ["wall_touch_1gang_hybrid", "wall_touch_2gang_hybrid", "wall_touch_3gang_hybrid"],
      "capabilities": ["onoff.channel1", "onoff.channel2", "onoff.channel3", "switch_mode"],
      "flowCards": {
        "actions": [
          {"id": "channel_on", "title": {"en": "Channel [[channel]] on", "fr": "Canal [[channel]] on"}, "args": [{"type": "dropdown", "name": "channel", "values": [1, 2, 3]}]},
          {"id": "channel_off", "title": {"en": "Channel [[channel]] off", "fr": "Canal [[channel]] off"}},
          {"id": "set_mode", "title": {"en": "Set mode", "fr": "D√©finir mode"}, "args": [{"type": "dropdown", "name": "mode", "values": ["hybrid", "local"]}]}
        ],
        "triggers": [
          {"id": "channel_touched", "title": {"en": "Channel [[channel]] touched", "fr": "Canal [[channel]] touch√©"}},
          {"id": "multi_touch", "title": {"en": "Multiple channels touched", "fr": "Plusieurs canaux touch√©s"}}
        ],
        "conditions": [
          {"id": "channel_is_on", "title": {"en": "Channel [[channel]] is on", "fr": "Canal [[channel]] actif"}},
          {"id": "mode_is", "title": {"en": "Mode is [[mode]]", "fr": "Mode est [[mode]]"}}
        ]
      },
      "smartMode": "Auto-detect number of gangs & expose only relevant capabilities. Map Tuya datapoints ‚Üí channels automatically. Create dynamic flow-cards per gang for multi-tap or sync groups"
    }
  }
}
