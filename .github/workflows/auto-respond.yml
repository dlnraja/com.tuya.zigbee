name: ðŸ¤– Auto-Respond Issues/PRs

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

jobs:
  respond:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            const author = context.payload.issue?.user?.login || context.payload.pull_request?.user?.login;
            const isIssue = !!context.payload.issue;
            const number = context.issue.number;
            const title = context.payload.issue?.title || context.payload.pull_request?.title || '';
            
            // Check if it's a device request
            const isDeviceRequest = /fingerprint|device|sensor|switch|button|not work|pair/i.test(title);
            
            let msg = `Hi @${author}! ðŸ‘‹\n\n`;
            msg += `Thanks for your ${isIssue ? 'issue' : 'PR'}!\n\n`;
            
            if (isDeviceRequest) {
              msg += `## ðŸ“‹ Device Information Needed\n\n`;
              msg += `Please provide from **Homey Developer Tools** â†’ Zigbee â†’ Your Device:\n\n`;
              msg += `| Info | How to Get |\n`;
              msg += `|------|------------|\n`;
              msg += `| \`manufacturerName\` | Settings â†’ zb_manufacturer_name |\n`;
              msg += `| \`modelId\` | Settings â†’ zb_model_id |\n`;
              msg += `| Interview JSON | Click "Interview" button |\n\n`;
              msg += `ðŸ”— [Open Developer Tools](https://tools.developer.homey.app)\n\n`;
              msg += `### ðŸ’¡ Common Issues:\n`;
              msg += `- **Device shows "unknown"**: Re-pair after app update\n`;
              msg += `- **Wrong driver**: Check fingerprint conflicts\n`;
              msg += `- **Buttons not working**: Check TS004F scene mode\n\n`;
            }
            
            msg += `*ðŸ¤– Auto-response - maintainer will review soon.*`;
            
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: number,
              body: msg
            });
