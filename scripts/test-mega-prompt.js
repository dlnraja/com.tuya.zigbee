#!/usr/bin/env node const fs = require('fs'); const path = require('path'); console.log('ðŸ§ª TEST MEGA-PROMPT ULTIME'); console.log('=' .repeat(40)); class MegaPromptTester { constructor() { this.startTime = Date.now(); this.results = { structure: {}, scripts: {}, workflows: {}, templates: {}, reports: {} }; } async runAllTests() { console.log('ðŸŽ¯ DÃ©marrage des tests...'); try { // 1. Tester la structure await this.testStructure(); // 2. Tester les scripts await this.testScripts(); // 3. Tester les workflows await this.testWorkflows(); // 4. Tester les templates await this.testTemplates(); // 5. GÃ©nÃ©rer le rapport await this.generateTestReport(); const duration = Date.now() - this.startTime; console.log(`âœ… Tests terminÃ©s en ${duration}ms`); } catch (error) { console.error('âŒ Erreur tests:', error.message); } } async testStructure() { console.log('\nðŸ“ Test de la structure...'); const expectedDirs = [ 'drivers/tuya/lights', 'drivers/tuya/switches', 'drivers/tuya/plugs', 'drivers/tuya/sensors', 'drivers/tuya/thermostats', 'drivers/zigbee/onoff', 'drivers/zigbee/dimmers', 'drivers/zigbee/sensors', '.github/workflows', 'scripts', 'templates', 'ref', 'public/dashboard', 'sync' ]; for (const dir of expectedDirs) { const fullPath = path.join(__dirname, '..', dir); if (fs.existsSync(fullPath)) { console.log(` âœ… ${dir}`); this.results.structure[dir] = 'OK'; } else { console.log(` âŒ ${dir} - MANQUANT`); this.results.structure[dir] = 'MISSING'; } } } async testScripts() { console.log('\nðŸ”§ Test des scripts...'); const expectedScripts = [ 'scripts/renamer.js', 'scripts/validate.js', 'scripts/zalgo-fix.js', 'scripts/github-sync.js', 'scripts/dashboard-fix.js', 'scripts/translate-logs.js', 'scripts/detect-driver-anomalies.js', 'scripts/final-structure-cleaner.js', 'scripts/ultimate-fix.js', 'scripts/mega-complete-processor.js', 'scripts/full-project-rebuild.js' ]; for (const script of expectedScripts) { const fullPath = path.join(__dirname, '..', script); if (fs.existsSync(fullPath)) { console.log(` âœ… ${script}`); this.results.scripts[script] = 'OK'; } else { console.log(` âŒ ${script} - MANQUANT`); this.results.scripts[script] = 'MISSING'; } } } async testWorkflows() { console.log('\nðŸš€ Test des workflows...'); const expectedWorkflows = [ '.github/workflows/build.yml', '.github/workflows/validate-drivers.yml', '.github/workflows/monthly.yml' ]; for (const workflow of expectedWorkflows) { const fullPath = path.join(__dirname, '..', workflow); if (fs.existsSync(fullPath)) { console.log(` âœ… ${workflow}`); this.results.workflows[workflow] = 'OK'; } else { console.log(` âŒ ${workflow} - MANQUANT`); this.results.workflows[workflow] = 'MISSING'; } } } async testTemplates() { console.log('\nðŸ“„ Test des templates...'); const expectedTemplates = [ 'templates/driver-readme.md', 'templates/driver-compose.template.json', 'templates/assets/placeholder.svg' ]; for (const template of expectedTemplates) { const fullPath = path.join(__dirname, '..', template); if (fs.existsSync(fullPath)) { console.log(` âœ… ${template}`); this.results.templates[template] = 'OK'; } else { console.log(` âŒ ${template} - MANQUANT`); this.results.templates[template] = 'MISSING'; } } } async generateTestReport() { console.log('\nðŸ“Š GÃ©nÃ©ration du rapport de test...'); const report = `# ðŸ§ª RAPPORT DE TEST - MEGA-PROMPT ULTIME ## ðŸ“… Date **${new Date().toLocaleString('fr-FR')}** ## ðŸ“Š RÃ©sultats des Tests ### ðŸ“ Structure ${Object.entries(this.results.structure).map(([dir, status]) => `- ${status === 'OK' ? 'âœ…' : 'âŒ'} ${dir}` ).join('\n')} ### ðŸ”§ Scripts ${Object.entries(this.results.scripts).map(([script, status]) => `- ${status === 'OK' ? 'âœ…' : 'âŒ'} ${script}` ).join('\n')} ### ðŸš€ Workflows ${Object.entries(this.results.workflows).map(([workflow, status]) => `- ${status === 'OK' ? 'âœ…' : 'âŒ'} ${workflow}` ).join('\n')} ### ðŸ“„ Templates ${Object.entries(this.results.templates).map(([template, status]) => `- ${status === 'OK' ? 'âœ…' : 'âŒ'} ${template}` ).join('\n')} ## ðŸ“ˆ Statistiques - **Structure**: ${Object.values(this.results.structure).filter(v => v === 'OK').length}/${Object.keys(this.results.structure).length} OK - **Scripts**: ${Object.values(this.results.scripts).filter(v => v === 'OK').length}/${Object.keys(this.results.scripts).length} OK - **Workflows**: ${Object.values(this.results.workflows).filter(v => v === 'OK').length}/${Object.keys(this.results.workflows).length} OK - **Templates**: ${Object.values(this.results.templates).filter(v => v === 'OK').length}/${Object.keys(this.results.templates).length} OK ## ðŸŽ¯ MEGA-PROMPT ULTIME Status **âœ… Tests terminÃ©s avec succÃ¨s** --- **ðŸ“… GÃ©nÃ©rÃ©**: ${new Date().toISOString()} **ðŸŽ¯ Objectif**: Validation du MEGA-PROMPT ULTIME **âœ… Statut**: **TESTS COMPLÃ‰TÃ‰S** `; const reportPath = path.join(__dirname, '../MEGA-PROMPT-TEST-REPORT.md'); fs.writeFileSync(reportPath, report); console.log(`âœ… Rapport de test gÃ©nÃ©rÃ©: ${reportPath}`); } } // ExÃ©cution const tester = new MegaPromptTester(); tester.runAllTests().catch(console.error); 

// Enhanced error handling
process.on('unhandledRejection', (reason, promise) => {
    console.error('Unhandled Rejection at:', promise, 'reason:', reason);
});

process.on('uncaughtException', (error) => {
    console.error('Uncaught Exception:', error);
});